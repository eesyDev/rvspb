{"version":3,"file":"calculator.js","sources":["calculator.js"],"sourcesContent":["(function () {\n    function getPanelForService(input) {\n      const wrap = input.closest('.switch-wrapper');\n      if (!wrap) return null;\n  \n      const key = input.dataset.panelFor || input.name || input.id;\n      if (key) {\n        const direct = wrap.querySelector('.switch-panel[data-panel-for=\"' + key + '\"]');\n        if (direct) return direct;\n      }\n  \n      const services = [...wrap.querySelectorAll('.switch-outer .service')];\n      const panels   = [...wrap.querySelectorAll('.switch-panel')];\n      const idx = services.indexOf(input);\n      return idx > -1 ? panels[idx] || null : null;\n    }\n  \n    function togglePanel(panel, open) {\n      if (!panel) return;\n      panel.setAttribute('aria-hidden', String(!open));\n      panel.classList.toggle('is-open', open);\n  \n      panel.querySelectorAll('input, select, textarea, button').forEach(el => {\n        if (!el.classList.contains('service')) el.disabled = !open;\n        if (!open && (el.type === 'checkbox' || el.type === 'radio')) el.checked = false;\n      });\n  \n      if (open) {\n        panel.style.maxHeight = panel.scrollHeight + 'px';\n      } else {\n        panel.style.maxHeight = panel.scrollHeight + 'px';\n        requestAnimationFrame(() => { panel.style.maxHeight = '0px'; });\n      }\n    }\n  \n    document.addEventListener('change', function (e) {\n      if (!e.target.matches('.service')) return;\n      const wrap = e.target.closest('.switch-wrapper');\n      const panel = getPanelForService(e.target);\n  \n      if (e.target.checked) {\n        // üîπ –ó–∞–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ –≤ —ç—Ç–æ–º .switch-wrapper\n        // wrap.querySelectorAll('.switch-panel.is-open').forEach(p => {\n        //   if (p !== panel) togglePanel(p, false);\n        // });\n      }\n  \n      togglePanel(panel, e.target.checked);\n    });\n  \n    document.querySelectorAll('.service').forEach(input => {\n      const panel = getPanelForService(input);\n      if (!panel) return;\n      if (input.checked) {\n        panel.classList.add('is-open');\n        panel.style.maxHeight = panel.scrollHeight + 'px';\n        panel.setAttribute('aria-hidden', 'false');\n        panel.querySelectorAll('input, select, textarea, button').forEach(el => {\n          if (!el.classList.contains('service')) el.disabled = false;\n        });\n      } else {\n        panel.setAttribute('aria-hidden', 'true');\n        panel.style.maxHeight = '0px';\n      }\n    });\n  })();\n\n\n$(function () {\n    var basePerM2 = {\n        finish: 500,      // –° –æ—Ç–¥–µ–ª–∫–æ–π\n        without_finish: 300,   // –ë–µ–∑ –æ—Ç–¥–µ–ª–∫–∏\n        rought: 200,         // –ß–µ—Ä–Ω–æ–≤–∞—è\n        fine: 400,          // –ß–∏—Å—Ç–æ–≤–∞—è\n\n    };\n\n    var $variant = $('#variant');\n    var $area    = $('#area');\n    var $ppsqm   = $('.calculate-way .value');\n    var $totalEl = $('.selected-sum');\n\n    function getArea(){\n        return parseFloat(($area.val() || '').replace(',', '.')) || 0;\n    }\n\n    function getCurrentM2(){\n        var key = $variant.val();\n        return basePerM2[key] || 0;\n    }\n\n    function recalc(){\n        var area = getArea();\n        var base = getCurrentM2() * area;\n\n        var addFixed = 0;\n        $('.service:checked').each(function(){\n            addFixed += parseFloat($(this).data('price')) || 0;\n        });\n\n        var addPerM2 = 0;\n        $('.subservice:checked').each(function(){\n            addPerM2 += (parseFloat($(this).data('price')) || 0) * area;\n        });\n\n        $ppsqm.text(getCurrentM2() + ' ‚ÇΩ/–º¬≤');\n        $totalEl.text((base + addFixed + addPerM2).toLocaleString('ru-RU') + ' —Ä—É–±.');\n        updateSelectedParams();\n    }\n\n    $variant.on('change', recalc);\n    $area.on('input change', recalc);\n    $(document).on('change', '.service, .subservice', recalc);\n\n\n    function updateSelectedParams() {\n        var $list = $('#selectedParams');\n        $list.empty(); // –æ—á–∏—â–∞–µ–º —Å–ø–∏—Å–æ–∫\n    \n        var area = getArea();\n    \n        // 1. –ë–∞–∑–æ–≤—ã–π –≤–∞—Ä–∏–∞–Ω—Ç –æ—Ç–¥–µ–ª–∫–∏\n        var variantText = $('#variant option:selected').text();\n        if (variantText) {\n            $list.append('<li>' + variantText + ' ‚Äî ' + getCurrentM2() + ' ‚ÇΩ/–º¬≤</li>');\n        }\n    \n        // 2. –§–∏–∫—Å-—É—Å–ª—É–≥–∏ (.service)\n        $('.service:checked').each(function(){\n            var name = $(this).data('name');\n            var price = parseFloat($(this).data('price')) || 0;\n            if (name) {\n                $list.append('<li>' + name + ' ‚Äî ' + price.toLocaleString('ru-RU') + ' ‚ÇΩ</li>');\n            }\n        });\n    \n        // 3. –£—Å–ª—É–≥–∏ –∑–∞ –º¬≤ (.subservice)\n        $('.subservice:checked').each(function(){\n            var name = $(this).closest('.panel__row').find('.panel-toggle__title').text().trim();\n            var pricePerM2 = parseFloat($(this).data('price')) || 0;\n            var total = pricePerM2 * area;\n            if (name) {\n                $list.append('<li>' + name + ' ‚Äî ' + pricePerM2 + ' ‚ÇΩ/–º¬≤ (' + total.toLocaleString('ru-RU') + ' ‚ÇΩ)</li>');\n            }\n        });\n    }\n    \n    \n\n    recalc(); // –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ\n});\n"],"names":["getPanelForService","input","wrap","closest","key","dataset","panelFor","name","id","direct","querySelector","services","querySelectorAll","panels","idx","indexOf","document","addEventListener","e","panel","open","target","matches","checked","setAttribute","String","classList","toggle","forEach","el","contains","disabled","type","style","maxHeight","scrollHeight","requestAnimationFrame","add","$","basePerM2","finish","without_finish","rought","fine","$variant","$area","$ppsqm","$totalEl","getArea","parseFloat","val","replace","getCurrentM2","recalc","area","base","addFixed","addPerM2","each","this","data","$list","text","toLocaleString","empty","variantText","append","price","find","trim","pricePerM2","total","on"],"mappings":"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"}